<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Noise Loss Demo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      font-family: "Helvetica Neue", Arial, sans-serif;
      margin: 0;
      line-height: 1.6;
      background: linear-gradient(rgba(255,255,255,0.9), rgba(255,255,255,0.9)),
                  url("assets/img/ink-bg.png");
      background-repeat: no-repeat;
      background-position: center top;
      background-size: cover;
      color: #111;
      text-align: center;
    }
    
    .table-of-contents {
      position: fixed;
      left: 20px;
      top: 50%;
      transform: translateY(-50%);
      background: transparent;
      border: none;
      border-radius: 0;
      padding: 20px;
      box-shadow: none;
      z-index: 1000;
      max-width: 250px;
      text-align: left;
    }
    
    .table-of-contents h3 {
      margin: 0 0 15px 0;
      font-size: 1.1em;
      color: #333;
      text-align: center;
      border-bottom: 2px solid #333;
      padding-bottom: 10px;
      font-weight: 600;
    }
    
    .table-of-contents ul {
      list-style: none;
      padding: 0;
      margin: 0;
    }
    
    .table-of-contents li {
      margin: 8px 0;
    }
    
    .table-of-contents a {
      text-decoration: none;
      color: #666;
      font-size: 0.9em;
      display: block;
      padding: 8px 12px;
      border-radius: 6px;
      transition: all 0.3s;
      background: rgba(255, 255, 255, 0.8);
      backdrop-filter: blur(5px);
    }
    
    .table-of-contents a:hover {
      background: rgba(0, 0, 0, 0.8);
      color: white;
      transform: translateX(5px);
    }
    
    .table-of-contents a.active {
      background: rgba(0, 0, 0, 0.9);
      color: white;
      font-weight: 500;
    }
    
    .main-content {
      margin-left: 300px;
    }
    
    @media (max-width: 1200px) {
      .table-of-contents {
        display: none;
      }
      .main-content {
        margin-left: 0;
      }
    }
    
    header {
      padding: 80px 20px 40px;
    }
    h1 {
      font-size: 2.5em;
      letter-spacing: 2px;
      margin-bottom: 10px;
      font-family: "STSong", "KaiTi", serif;
    }
    h2 {
      font-weight: 300;
      font-size: 1.2em;
      color: #444;
    }
    section {
      margin: 60px auto;
      max-width: 1200px;
      padding: 0 20px;
    }
    img {
      max-width: 100%;
      margin: 20px 0;
    }
    .small-figure {
      max-width: 60% !important;
    }
    audio {
      margin: 10px auto 30px;
      display: block;
      width: 100%;
      max-width: 300px;
    }
    .caption {
      font-size: 0.9em;
      color: #333;
      margin-top: -10px;
    }
    .btn {
      display: inline-block;
      margin: 20px auto;
      padding: 10px 20px;
      border: 1px solid black;
      text-decoration: none;
      color: black;
      font-size: 1em;
      transition: background 0.2s;
    }
    .btn:hover {
      background: black;
      color: white;
    }
    footer {
      font-size: 0.8em;
      color: #555;
      padding: 40px 20px;
      border-top: 1px solid #ccc;
    }
    .demo-container {
      display: flex;
      gap: 20px;
      justify-content: space-between;
      flex-wrap: wrap;
      margin: 40px auto;
    }
    .demo-group {
      flex: 1;
      min-width: 300px;
      padding: 20px;
      border: 1px solid #ddd;
      border-radius: 8px;
      background: rgba(255,255,255,0.8);
      box-sizing: border-box;
    }
    .demo-group h3 {
      margin-top: 0;
      color: #333;
      font-size: 1.1em;
    }
    .demo-group p {
      font-size: 0.9em;
      margin: 10px 0;
    }
    .demo-group img {
      margin: 15px 0;
    }
    @media (max-width: 1000px) {
      .demo-container {
        flex-direction: column;
      }
      .demo-group {
        min-width: auto;
      }
    }
  </style>
</head>
<body>
  <nav class="table-of-contents">
    <ul>
      <li><a href="#about">About this Work</a></li>
      <li><a href="#noise-injection">Noise Injection Experiment</a></li>
      <li><a href="#audio-demos">Audio Demos & Loss Analysis</a></li>
      <li><a href="#different-noise">Loss under Different Noise</a></li>
      <li><a href="#loss-dynamics">Loss Curve Dynamics</a></li>
      <li><a href="#supplement">Supplement Experiments</a></li>
    </ul>
  </nav>

  <div class="main-content">
    <header>
      <h1>WHEN NOISE LOWERS THE LOSS</h1>
      <h2>Rethinking Likelihood-based Evaluation in Music LLMs</h2>
      <a href="paper/paper.pdf" class="btn" target="_blank">Read the Paper</a>
    </header>

    <section id="about">
      <h2>About this Work</h2>
      <p>
        We discovered that injecting noise into music often lowers the loss in Music LLMs,
        making absolute loss unreliable for evaluation.
        Instead, the <b>shape of the loss curve</b>—its peaks and phases—provides more meaningful signals for evaluation. Here are supplementary materials and experiments to support this effect.
      </p>
    </section>

    <section id="noise-injection">
    <h2>Noise Injection Experiment</h2>
    <p>
    When noise is injected, the model's loss first spikes, showing it detects inconsistency. 
    But almost immediately the loss drops and stays low, because some forms of noise are actually easier for the model to predict than real music. 
    After the noise ends, the loss returns to the musical context but with higher variance. 
    This counterintuitive behavior—brief resistance, then forgetting and adapting to noise—reveals a fundamental limitation of likelihood-based evaluation in music LLMs.</p>
    <p>
      Core result: after noise at 5s (~token 250), the loss quickly
      drops and stays low because noisy audio is easier to predict
      than real music.
    </p>
    <div class="figure-block">
    <img src="assets/img/figure1.png" alt="Context Amnesia Effect" class="small-figure">
    <p><b>Figure 1. Context Amnesia Effect.</b> </p>
    </div>
    </section>

    <section id="audio-demos">
      <h2>Audio Demos & Loss Difference Analysis</h2>
        <p>
        When noise is injected, the model's loss first spikes, showing it detects inconsistency. 
        But almost immediately the loss drops and stays low.</p>
        <p>
          X-axis: tokens 200–750; noise at token 250. Loss difference
          stays ~0 before 250, then changes. Definition:
          Loss(music + perturb) − Loss(original).
        </p>
    <div class="demo-container">
      <div class="demo-group">
        <h3>OOD Datasets - Beethoven_010</h3>
        <p>Original</p>
        <audio controls>
          <source src="assets/audio/ori_Beethoven_010.wav" type="audio/mpeg">
        </audio>
        <p>Noise Injected at 5 Seconds for 100 Tokens (2 Sec) Long</p>
        <audio controls>
          <source src="assets/audio/whiteNoise_Beethoven_010.wav" type="audio/mpeg">
        </audio>
        <img src="assets/img/loss_diff_Beethoven_010.png" alt="Loss Difference">
        <p><b>Loss Difference.</b> </p>
      </div>

      <div class="demo-group">
        <h3>OOD Datasets - Chopin_073</h3>
        <p>Original</p>
        <audio controls>
          <source src="assets/audio/ori_Chopin_073.wav" type="audio/mpeg">
        </audio>
        <p>Noise Injected at 5 Seconds for 100 Tokens (2 Sec) Long</p>
        <audio controls>
          <source src="assets/audio/whiteNoise_Chopin_073.wav" type="audio/mpeg">
        </audio>
        <img src="assets/img/loss_diff_Chopin_073.png" alt="Loss Difference">
        <p><b>Loss Difference.</b> </p>
      </div>

      <div class="demo-group">
        <h3>OOD Datasets - Schubert_062</h3>
        <p>Original</p>
        <audio controls>
          <source src="assets/audio/ori_Schubert_062.wav" type="audio/mpeg">
        </audio>
        <p>Noise Injected at 5 Seconds for 100 Tokens (2 Sec) Long</p>
        <audio controls>
          <source src="assets/audio/whiteNoise_Schubert_062.wav" type="audio/mpeg">
        </audio>
        <img src="assets/img/loss_diff_Schubert_062.png" alt="Loss Difference">
        <p><b>Loss Difference.</b> </p>
      </div>
    </div>

    <div class="demo-container">
      <div class="demo-group">
        <h3>Generated Datasets - Topk = 250 - Sample 004</h3>
        <p>Original</p>
        <audio controls>
          <source src="assets/audio/ori_sample_004.wav" type="audio/mpeg">
        </audio>
        <p>Noise Injected at 5 Seconds for 100 Tokens (2 Sec) Long</p>
        <audio controls>
          <source src="assets/audio/whiteNoise_sample_004.wav" type="audio/mpeg">
        </audio>
        <img src="assets/img/loss_diff_unconditional_topk250_samples_sample_004.png" alt="Loss Difference">
        <p><b>Loss Difference.</b> </p>
      </div>

      <div class="demo-group">
        <h3>Generated Datasets - Topk = 250 - Sample 005</h3>
        <p>Original</p>
        <audio controls>
          <source src="assets/audio/ori_sample_005.wav" type="audio/mpeg">
        </audio>
        <p>Noise Injected at 5 Seconds for 100 Tokens (2 Sec) Long</p>
        <audio controls>
          <source src="assets/audio/whiteNoise_sample_005.wav" type="audio/mpeg"> 
        </audio>
        <img src="assets/img/loss_diff_unconditional_topk250_samples_sample_005.png" alt="Loss Difference">
        <p><b>Loss Difference.</b> </p>
      </div>

      <div class="demo-group">
        <h3>Generated Datasets - Topk = 250 - Sample 006</h3>
        <p>Original</p>
        <audio controls>
          <source src="assets/audio/ori_sample_006.wav" type="audio/mpeg">
        </audio>
        <p>Noise Injected at 5 Seconds for 100 Tokens (2 Sec) Long</p>
        <audio controls>
          <source src="assets/audio/whiteNoise_sample_006.wav" type="audio/mpeg"> 
        </audio>
        <img src="assets/img/loss_diff_unconditional_topk250_samples_sample_006.png" alt="Loss Difference">
        <p><b>Loss Difference.</b> </p>
      </div>
    </div>

    <div class="demo-container">
      <div class="demo-group">
        <h3>Training Datasets - Spreading Your Wings</h3>
        <p>Original</p>
        <audio controls>
          <source src="assets/audio/ori_spreading-your-wings.mp3" type="audio/mpeg">
        </audio>
        <p>Noise Injected at 5 Seconds for 100 Tokens (2 Sec) Long</p>
        <audio controls>
          <source src="assets/audio/whiteNoise_spreading-your-wings.wav" type="audio/mpeg">
        </audio>
        <img src="assets/img/loss_diff_spreading-your-wings.png" alt="Loss Difference">
        <p><b>Loss Difference.</b> </p>
      </div>

      <div class="demo-group">
        <h3>Training Datasets - The Drive for Resolution</h3>
        <p>Original</p>
        <audio controls>
          <source src="assets/audio/ori_the-drive-for-resolution.mp3" type="audio/mpeg">
        </audio>
        <p>Noise Injected at 5 Seconds for 100 Tokens (2 Sec) Long</p>
        <audio controls>
          <source src="assets/audio/whiteNoise_the-drive-for-resolution.wav" type="audio/mpeg">
        </audio>
        <img src="assets/img/loss_diff_the-drive-for-resolution.png" alt="Loss Difference">
        <p><b>Loss Difference.</b> </p>
      </div>

      <div class="demo-group">
        <h3>Training Datasets - Wistful Longing</h3>
        <p>Original</p>
        <audio controls>
          <source src="assets/audio/ori_wistful-longing.mp3" type="audio/mpeg">
        </audio>
        <p>Noise Injected at 5 Seconds for 100 Tokens (2 Sec) Long</p>
        <audio controls>
          <source src="assets/audio/whiteNoise_wistful-longing.wav" type="audio/mpeg">
        </audio>
        <img src="assets/img/loss_diff_wistful-longing.png" alt="Loss Difference">
        <p><b>Figure 1. Loss Difference.</b> </p>
      </div>
    </div>
    </section>
    
    <section id="different-noise">
    <h2>Loss under Different Noise Injection</h2>
    <p>Across blue/pink/brown noise types, CE loss remains steady.</p>
    <div class="figure-block">
      <img src="assets/img/OOD_all_noise.png" alt="Loss under Different Noise Injection - OOD Datasets">
      <p><b>Figure 2-1. Loss under Different Noise Injection - OOD Datasets.</b> </p>
    </div>

    <div class="figure-block">
      <img src="assets/img/generated_all_noise.png" alt="Loss under Different Noise Injection - Generated Datasets">
      <p><b>Figure 2-2. Loss under Different Noise Injection - Generated Datasets.</b> </p>
    </div>

    <div class="figure-block">
      <img src="assets/img/training_all_noise.png" alt="Loss under Different Noise Injection - Training Datasets">
      <p><b>Figure 2-3. Loss under Different Noise Injection - Training Datasets.</b> </p>
    </div>
    </section>

    <section id="loss-dynamics">
    <h2>Loss Curve Dynamics</h2>
    <p> Three phases: Peak → Assimilation → Recovery.</p>

    <div class="figure-block">
      <img src="assets/img/figure3.png" alt="Loss Curve Dynamics" class="small-figure">
      <p><b>Figure 3. Loss Curve Dynamics.</b> 
      </p>
    </div>
    </section>

    <section id="supplement">
    <h2>Supplement Experiments 1</h2>
    <p>Additional tests (rhythm deletion, velocity, structure) further show absolute loss is unreliable.</p>

  <div class="demo-container">
    <div class="demo-group">
      <h3>Rhythm Deletion</h3>
      <p>Original</p>
      <audio controls>
        <source src="assets/audio/ori_Beethoven_090.wav" type="audio/mpeg">
      </audio>
      <p>Rhythm deletion for 40 percents of the original music.</p>
      <audio controls>
        <source src="assets/audio/Beethoven_090_rhythm1_4_step1_r40.wav" type="audio/mpeg">
      </audio>
      <img src="assets/img/supplement1_rhythm.png" alt="Rhythm Deletion">
      <p><b>Figure 4-1. Rhythm Deletion.</b></p>
    </div>

    <div class="demo-group">
      <h3>Note Velocity Change</h3>
      <p>Original</p>
      <audio controls>
        <source src="assets/audio/ori_Beethoven_090.wav" type="audio/mpeg">
      </audio>
      <p>Note velocity changed for 80 percents of the original music.</p>
      <audio controls>
        <source src="assets/audio/Beethoven_090_velocity1_1_step1_nt80.wav" type="audio/mpeg">
      </audio>
      <img src="assets/img/supplement1_velocity.png" alt="Dynamic Change">
      <p><b>Figure 4-2. Note Velocity Change.</b></p>
    </div>

    <div class="demo-group">
      <h3>Structure Change</h3>
      <p>Original</p>
      <audio controls>
        <source src="assets/audio/Beethoven_090_velocity1_1_step1_nt80.wav" type="audio/mpeg">
      </audio>
      <p>Structure changed for 80 percents of the original music.</p>
      <audio controls>
        <source src="assets/audio/Beethoven_090_tempo1_1_step1_nt80.wav" type="audio/mpeg">
      </audio>
      <img src="assets/img/supplement1_structure.png" alt="Structure Change">
      <p><b>Figure 4-3. Structure Change.</b></p>
    </div>
  </div>
    </section>

    <footer>
      <p>&copy; 2025 Noise Loss Project by Xiaosha Li, Chun Liu, and Ziyu Wang. All rights reserved.</p>
    </footer>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const links = document.querySelectorAll('.table-of-contents a');
      const sections = document.querySelectorAll('section[id]');
      
      links.forEach(link => {
        link.addEventListener('click', function(e) {
          e.preventDefault();
          const targetId = this.getAttribute('href').substring(1);
          const targetSection = document.getElementById(targetId);
          if (targetSection) {
            targetSection.scrollIntoView({
              behavior: 'smooth',
              block: 'start'
            });
          }
        });
      });
      
      function highlightCurrentSection() {
        let current = '';
        sections.forEach(section => {
          const sectionTop = section.offsetTop;
          const sectionHeight = section.clientHeight;
          if (window.pageYOffset >= sectionTop - 100) {
            current = section.getAttribute('id');
          }
        });
        
        links.forEach(link => {
          link.classList.remove('active');
          if (link.getAttribute('href') === '#' + current) {
            link.classList.add('active');
          }
        });
      }
      
      window.addEventListener('scroll', highlightCurrentSection);
      highlightCurrentSection(); 
    });
  </script>
</body>
</html>

